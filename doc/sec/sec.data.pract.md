# 数据安全合规实践

[数据安全合规实践（一）安全需求评审：业务研发团队提交信息](https://www.freebuf.com/articles/database/251925.html)
[数据安全合规实践（二） 安全需求评审：信息采集部分评审 会员](https://www.freebuf.com/articles/database/252219.html)
[数据安全合规实践（三）：数据溯源系统的思考](https://www.freebuf.com/articles/database/252222.html)
[企业合规视角下的《个人信息保护法 (草案) 》解读](https://www.freebuf.com/articles/neopoints/253546.html)
[从技术角度解读《数据安全法（草案）》二审稿](http://blog.nsfocus.net/426-429-20/)
[GDPR笔记（4）：数据保护影响评估（DPIA）之“高风险”认定](https://zhuanlan.zhihu.com/p/134369950)


### 0x01安全需求评审的内容

在《信息安全技术 个人信息安全规范》中，
  前提: 规定了在某些场景下，需进行个人信息安全影响评估
  包括:
    信息所用于的目的
    根据评估应当采取的安全措施等等。
在GDPR中，第35条提出了企业要进行DPIA的要求，
  步骤一般分为3步:
    即项目负责人填写初步清单
    是否进行DPIA评估
    实施DPIA
  这其中包括
    是否收集个人信息
    使用目的
    处理方式
    数据主体权利的履行措施、保护措施等等。
iso27701中，7.2.5条说明需进行隐私影响评估，其中7.2.8中说明应当涉及将被处理的个人信息类型、处理目的、相关信息描述、接收者类别、技术及组织安全措施等等。

可以看出DPIA的进行其实和安全需求评审的实施阶段类似
  都是在项目立项或者需求阶段进行介入；
  其次，安全需求评审往往也需要
    了解业务涉及的敏感级别、
    业务的目的、
    处理方式、
    安全措施等情况
在内容上和DPIA需要研发所提供的信息有重合的地方， 因此两者可以合并在一起进行。

关于在安全需求评审阶段进行DPIA，应当如何设计各个模块，可以参考各个主要法律法规和标准。
在《个人信息安全规范》中，分别从个人信息的收集、存储、使用、共享等个人信息全生命周期各个环节进行要求。
在《数据安全能力成熟度模型》中，也主要通过数据的全生命周期各个阶段进行指导。
而GDPR中，更多使用的是“处理”这一概念，涵盖所有围绕个人信息的操作，更侧重于数据主体的权利，这些权利不是针对数据全生命周期的某一特定环节。

由此可以看出，我们可以从个人信息全生命周期各个阶段和数据主体权利来设计各个模块。

除了相关法律法规、国家标准以外，对于某些细化类别，我们也可以参考相关配套标准或者实践指南进行设计。
《app收集使用个人信息自评估指南》可以看做是对《个人信息安全规范》中的个人信息收集和信息主体权利部分的一种细化，实践的具体要求。
《个人信息告知同意指南》也具体指出了很多细化场景。
GDPR因为刻意避免提出相关技术措施，因此对于实施细节，说明较少，往往是通过第29条工作组或者监管机构如英国ICO的解释进行指导，如cookies的合规、同意的解释等等。



### 0x02需要业务研发团队提供的信息

在《个人信息安全规范》和GDPR中，都提到了收集个人信息的两种方式，
即直接收集个人信息
和间接收集个人信息。

其中，《个人信息安全规范》中提到，如果产品或服务的提供者提供工具供个人信息主体使用，提供者不对个人信息进行访问的，则不属于个人信息收集。
  规范同时举了个例子，即采集的信息不回传给软件提供者，则不算个人信息收集。
这里要注意一下，在GDPR中，并没有发现类似规定，在GDPR中，这类也算是信息处理的一种方式。

数据采集或者个人信息的采集，一般需要了解三个部分：
采集了什么数据，
采集的目的是什么，
如何采集的。

但是根据整个安全需求评审的逻辑来看，
  应该是先看当前版本主要开发了什么新的业务模块，
  为了实现这个业务模块需要哪些数据（是否包含个人信息），
  这些数据是如何获取的。

（1）当前涉及的业务模块

2020年版《app收集使用个人信息自评估指南》评估点二
  “是否明示收集使用个人信息的目的、方式和范围”中，要求完整列举，不允许使用“等”“例如”等方式。

对于“目的”列出了相关举例，如下所示：
  地图导航，网络约车，即时通讯，网络支付，新闻资讯，网上购物，短视频，快递物流，餐饮外卖，交通票务，婚恋相亲，房屋租售，求职招聘，网络借贷等。

根据《信息安全技术 移动互联网应用程序收集个人信息基本规范》，其中列出了一系列业务功能，如下所示：

业务功能 描述
地图导航 为用户提供互联网地图和导航功能
网络约车 为用户提供网络预约汽车（不包含汽车租赁）服务
即时通信 为用户提供在线文字、语音、视频等形式的通讯服务，或基于即时通讯的交友互动等服务

网络社区 为用户提供博客、论坛、社区等服务，包括话题讨论、信息分享和关注互动等功能

网路支付 为用户提供在收付款人之间转移货币资金的服务（如非银支付、网银支付），包括支付、提现、转账、账单等功能

新闻资讯 为用户提供图文、音视频等新闻资讯信息服务，包括新闻资讯的浏览、搜索和发布功能

网上购物 为用户提供网上购买商品或服务的服务类型，包括商品展示、搜索、下单、交付、客服售后等功能

短视频 为用户提供短视频服务，包括浏览、搜索、制作、发布短视频和社交互动等功能

快递配送 为用户提供信件、包裹、印刷品等物品的寄递服务，包括寄件、查件、收件等功能

餐饮外卖 为用户提供餐饮等外卖信息和外卖服务，包括餐饮配送、到店自取等功能

交通票务 为用户提供交通相关的票务服务，包括票务查询、购买、改签、退票等功能

婚恋相亲 为用户提供征婚服务，包括异性推荐、相亲牵线等功能

求职招聘 为用户提供网上招聘和求职服务，包括职位发布、职位展示、职位搜索、投递简历等功能

金融借贷 为用户提供从金融机构进行个人消费贷款服务，包括授信、借款、还款与交易记录等功能，这里的金融机构是指有放贷资质的银行、消费金融公司、小贷公司等在网络上提供借贷服务的机构

房屋租售 为用户提供房源信息、房屋出租服务，包括房源展示、房源搜索、房屋出租等功能

二手车交易 二手车交易为用户提供汽车资讯、二手车交易服务，包括车源信息搜索和展示、车辆审核和二手车买卖等功能

运动健身 为用户提供运动记录和健康建议服务，包括健身运动管理、健康建议等功能

问诊挂号 为用户提供在线问诊、在线挂号的医疗服务

网页浏览器 为用户提供通过输入网址或站点导航浏览网上信*息资源功能的服务，包括网页浏览、文件下载、资源收藏等功能

输入法 为用户提供通过键盘、手写、语音等方式输入字符功能的服务

安全管理 为用户提供查杀木马病毒、清理恶意插件、修复漏洞、清理优化、骚扰拦截、权限管理等功能

旅游服务 为用户提供景点信息、旅游路线规划服务，包括景点展示、景点搜索、旅行路线设计等功能

酒店服务 为用户提供酒店信息、酒店预订服务，包括酒店展示、酒店搜索、酒店预订等功能

网络游戏 通过互联网、移动通信网等信息网络，为用户提供游戏产品和服务

在线影音 为用户提供在线音视频服务，包括浏览、展示、搜索、播放、下载音视频等功能

儿童教育 为用户提供儿童早教、儿童在线教育服务，包括儿歌教育、童话教育、早教练习等功能

电子图书 为用户提供读书、听书、漫画等电子图书阅读功能

拍摄美化 为用户提供拍摄照片、摄影、美颜、滤镜、表情包、个性化贴纸等服务

应用商店 为用户提供移动互联网应用程序下载、管理等服务

网络直播 为用户提供以视频、音频、图文等形式持续发布实时信息的服务

------------

以上业务，需根据各公司实际情况进行微调或者合并（比如将涉及较少的业务功能统一先归并到“其他”里面）。

在GDPR当中，并非如上通过业务功能进行要求，而是从对数据主体所享有的基本权利产生影响的角度出发，提出一系列处理方式类型。具体如下：

类型 举例
是否对数据主体进行评估和评分 如应聘者测试评估，员工绩效评估
是否涉及具有法律或类似重大影响的自动决策，尤其是拒绝服务 如信贷自动审批，基于异常行为的自适应风险阻断
是否向第三方披露 将个人数据转移到新的供应商或位于英国/欧洲经济区以外的地方，或新的地点
是否会使用创新技术（特别是可能被认为侵犯隐私的新技术）？或以新的方式使用现有技术？ 例如，使用生物识别技术（如指纹识别）登录应用程序，使用面部识别系统以验证身份和接受送货。

同时，要考虑到不同法律法规和标准的适用范围，因此还需要了解该功能模块面向服务对象的范围。
  可使用该服务模块的用户所在国家范围
  可使用该服务模块的用户的年龄范围
  提供该服务的控制者主体所在国家范围

（2）该功能模块需要的数据

在法律法规或者标准中，对于个人信息的定义较广，

尤其是GDPR，其第4条规定，“个人数据”是指已识别到的或可被识别的自然人的所有信息。
所以，完全让研发团队说明自己采集了哪些个人信息，势必会漏掉很多在常见语境下，不被认为是“个人信息”。
因此，需要给研发团队列明相关个人信息和个人敏感信息。

《个人信息安全规范》划分了个人信息和个人敏感信息两大信息。

表1个人信息举例

个人基本资料 个人姓名、生日、性别、民族、国籍、家庭关系、住址、个人电话号码、电子邮件地址等
个人身份信息 身份*证、军官*证、护*照、驾驶*证、工作*证、出入证、社保卡、居住证等
个人生物识别信息 个人基因、指纹、声纹、掌纹、耳廓、虹膜、面部识别特征等
网络身份标识信息 个人信息主体账号、IP地址、个人数字证书等
个人健康生理信息 个人因生病医治等产生的相关记录，如病症、住院志、医嘱单、检验报告、手术及麻醉记录、护理记录、用药记录、药物食物过敏信息、生育信息、以往病史、诊治情况、家族病史、现病史、传染病史等，以及与个人身体健康状况相关的信息，如体重、身高、肺活量等
个人教育工作信息 个人职业、职位、工作单位、学历、学位、教育经历、工作经历、培训记录、成绩单等
个人财产信息 银行账户、鉴别信息(口令)、存款信息（包括资金数量、支付收款记录等）、房产信息、信贷记录、征信信息、交易和消费记录、流水记录等，以及虚拟货币、虚拟交易、游戏类兑换码等虚拟财产信息
个人通信信息 通信记录和内容、短信、彩信、电子邮件，以及描述个人通信的数据（通常称为元数据）等
联系人信息 通讯录、好友列表、群列表、电子邮件地址列表等
个人上网记录 指通过日志储存的个人信息主体操作记录，包括网站浏览记录、软件使用记录、点击记录、收藏列表等
个人常用设备信息 指包括硬件序列号、设备MAC地址、软件列表、唯一设备识别码（如IMEI/Android ID/IDFA/OpenUDID/GUID/SIM卡IMSI信息等）等在内的描述个人常用设备基本情况的信息
个人位置信息 包括行踪轨迹、精准定位信息、住宿信息、经纬度等
其他信息 婚史、宗教信仰、性取向、未公开的违法犯罪记录等

表2个人敏感信息举例

个人财产信息 银行账户、鉴别信息(口令)、存款信息（包括资金数量、支付收款记录等）、房产信息、信贷记录、征信信息、交易和消费记录、流水记录等，以及虚拟货币、虚拟交易、游戏类兑换码等虚拟财产信息
个人健康生理信息 个人因生病医治等产生的相关记录，如病症、住院志、医嘱单、检验报告、手术及麻醉记录、护理记录、用药记录、药物食物过敏信息、生育信息、以往病史、诊治情况、家族病史、现病史、传染病史等
个人生物识别信息 个人基因、指纹、声纹、掌纹、耳廓、虹膜、面部识别特征等
个人身份信息 身份*证、军官*证、护*照、驾驶*证、工作*证、社保卡、居住证等
其他信息 性取向、婚史、宗教信仰、未公开的违法犯罪记录、通信记录和内容、通讯录、好友列表、群组列表、行踪轨迹、网页浏览记录、住宿信息、精准定位信息等

GDPR中，第9条规定了在GDPR管辖下的敏感个人数据，包括8类：

种族或民族出身
  政治观点
  宗教或哲学信仰
  工会会员资格
  基因数据
  生物学数据
  健康有关的数据
  性生活或性取向数

同时，在《个人信息安全规范》和GDPR中，
  都规定了收集或者处理个人信息的合法理由或者说是征得数据主体同意的例外情况，
因此，在进行该业务模块实现时，可以让研发项目团队提供需要该数据的原因。

这里要说明的是，从《个人信息安全规范》和《个人信息告知同意指南》可以看出，
  在采集个人信息时，应当征求数据主体的同意，然后再规定了可以不征求同意的情况。
  但是从GDPR可以看出，以及相应判例来看，“同意”并不是万能的，不能所有的采集都使用“同意”机制，因为“同意”是有“撤回同意”操作的合法理由必须适用适当。

根据《个人信息安全规范》，需要说明的原因包括：
  与个人信息控制者履行法律法规规定的义务相关
  与国家安全、国防安全直接相关
  与公共安全、公共卫生、重大公共利益直接相关
  与刑事侦查、起诉、审判和判决执行等直接相关
  出于维护个人信息主体或其他个人的生命、财产等重大合法权益但又很难得到本人授权同意的
  根据个人信息主体要求签订和履行合同所必需的
  维护所提供产品或服务的安全稳定运行所必需的
  新闻单位开展合法新闻报道所必需的
  学术研究机构，出于公共利益开展统计或学术研究所必要，且其对外提供学术研究或描述的结果时，对结果中所包含的个人信息进行去标识化处理的

具体示例，可以参考《个人信息告知同意指南》规定的相关不需取得同意的例外情形。

根据GDPR第6条规定，需要说明的原因包括：
  数据处理是为了履行控制者所负担的法律义务所必需（这里的法律义务是欧盟法或者欧盟成员国法，比如中国法并不属于这里的法律义务，因此应当区别对待）
  执行公共利益领域的任务或者公务职权
  数据处理是为保护数据主体或另一自然人的重大利益所必需
  履行数据主体作为一方的合同所必需
  数据处理是为实现控制者或者第三方所追求的合法利益所必需的

同时，为了满足PECR中的cookies政策，在数据采集中，应当再增加一部分，即cookies收集部分。需研发项目组提交的信息包括：
  cookie名称
  cookie所有者（比如是公司自己还是第三方统计分析的，如百度、谷歌）
  cookie类别（绝对必要、优化类、分析类、隐私偏好）
  cookie目的

PECR
  从英文翻译而来-《 2003年隐私和电子通信（EC指令）条例》是英国的一项法律，其中规定，未经订户事先同意，通过电话传输自动录制的消息以用于直接促销目的是违法的。该法律执行了欧盟指令，即2002年隐私和电子通信指令。该立法的主要原则之一是，如果当事人在双方以前没有任何关系的情况下未获得明确许可，则向其发送直销广告是违法的。 维基百科（英文)

（3）采集的方式

根据《个人信息告知同意指南》第5.1条，可以将个人信息采集方式细化如下：
  个人信息主体主动填写、选择、上传等主动提供个人信息的
  网络运营者通过智能终端、API、SDK、IoT设备、浏览器、传感器等自动采集个人信息的
  网络运营者通过与用户交互记录个人信息主体行为的
  网络运营者从第三方间接接受、查询等方式间接获取的
  网络运营者从非完全公开渠道搜集个人信息的
  网络运营者从个人信息主体关联身份或账号收集个人信息的
  网络运营者使用大数据、AI等技术分析、关联和生成个人信息的

这里再次涉及到《个人信息安全规范》和《个人信息告知同意指南》中，指出的例外情况。
  所涉及的个人信息是个人信息主体自行向社会公众公开的
  从合法公开披露的信息中收集个人信息的，如合法的新闻报道、政府信息公开等渠道

后续，会根据以上收集的信息，对如何提出安全评审的要求进行分享。

## 数据安全合规实践（二） 安全需求评审：信息采集部分评审

收集了这些信息后，**怎么去做安全需求评审**。

痛点问题：

（1）安全人员少，但系统多，没法覆盖（我所在公司，安全人员在100-200左右，应用安全组基本维持在10人左右，但需要面对集团活跃系统300-500套，每月发版次数在900次以上）；
（2）研发自提交的信息太简单，难以评审，每次都通过会议访谈又太耗时间；
（3）devsecops中对自动化要求较高，安全需求评审如何做到自动化；

自然，在安全需求评审中，融入数据合规内容，必然会增加工作量，也不会绕过上面三个问题。
分享我们在实践中遇到的问题和解决的方案

其实关于痛点2，在上一篇文章中，我们使用的方法有解决，
即**通过标准化的选项**，减少业务研发人员自组织语言，便于安全评审人员快速理解；
同时，通过举例，让业务研发人员理解安全合规的意图，减少对问题理解的误差。
这样从双向减少了沟通成本。
当然这里要注意一点，有些问题还是必然要进行访谈的，这个我们就不在这里展开了。

痛点1和痛点3其实是相关的，因为人力不足，效率低，所以要寄希望于自动化。
那么上一篇文章中，标准化的选项，就为自动化提供了前提。
当然在安全需求评审的自动化中，除了标准化的选项，我们还尝试了语义分析技术，但目前还在摸索过程中，各位大佬如果有好的想法也可以一起探讨。

在自动化的安全需求评审中，我们将需求分为以下几类：
（1）需求合理性评估，如对是否应当采集该数据进行评估；
（2）安全附加性要求，如对某个需求，附加需要注意的安全措施或者安全要求

### 0x01 何时需要触发

根据GDPR的要求，出于相同或类似的目的处理相同类型的个人数据，并且已经为这些活动完成了DPIA，那么则无需进行额外的DPIA。
因此，在此处，如果在业务研发团队提交了相同的业务功能模块、相同的采集数据集、相同的采集方式、相同的处理方式时，则不需要进行进一步评估。
当然，有人说不能信任研发团队提交的数据，这个时候，其实就是要靠后续审计、安全测试等来追责了。

### 0x02 数据采集必要性

根据《个人信息安全规范》中规定个人信息安全基本原则中，包含“最小必要”。
GDPR中，第5条中规定，“充分、相关并且应限制于为实现该个人数据处理目的所需的最小限度内”。
  DPIA中，最核心的部分就包括“必要性”评估。

怎么评估“必要性”，我们可以参考《app收集使用个人信息自评估指南》和《app违法违规收集使用个人信息自评估指南》。
  在《app收集使用个人信息自评估指南》中，评估点四，“是否遵循必要原则，仅收集与其提供的服务相关的个人信息”；
  《app违法违规收集使用个人信息自评估指南》中，评估项七“收集个人信息应满足必要性要求”。

（1）是否收集与业务功能无关的个人信息

这里可以参考《移动互联网应用程序收集个人信息基本规范》，其中，附录规定了各个业务功能，所需的最小必要信息。
  因此，当业务研发团队在选择了对应的业务功能时，则可以自动带出相关最小必要信息。
  若研发团队还要收集其他数据，则需要提供相关原因，进行人工审核。
  这就属于上面第一条需求合理性评估。

（2）是否会拒绝业务执行

在收集超出上述非必要信息时，如果用户不同意收集，不能拒绝提供正常业务。
同时在其他业务功能得到用户授权，取得最小必要权限的情况下，不得影响该应用其他业务功能的正常使用。
该要求可以直接提示给研发团队，如直接写入jira和测试用例。
这就是属于上面第二条附加性安全需求。

（3）是否一次性获取授权

当应用需要获取用户授权时，应当以即将使用的业务场景为区隔，分别获取权限，不能一次性索取所有权限。
在用户拒绝某一项权限后，仅当再次涉及到该业务时，才能提示用户进行授权。
该要求可以直接提示给研发团队，如直接写入jira和测试用例。
这就是属于上面第二条附加性安全需求。

（4）是否自动采集个人信息
当业务研发团队提交的信息中，选择了采集方式中，使用的是自动化的采集方式，那么应当进一步要求应当保证是最低频率。
这一点，往往是比较容易忽略的，该要求来自《个人信息安全规范》中第5.2条，“自动采集个人信息的频率应是实现产品或服务的业务功能所必需的最顶频率”。
而什么是最低频率，这里是需要人工审核的。
那么当业务研发团队选择了自动采集方式后，可以进一步附上采集的频率和原因（比如api接口的触发条件和访问频率）。

### 0x03 明示和同意

《个人信息安全规范》第4条基本原则中，包括“目的明确”、“选择同意”和“公开透明”几个原则，
  即收集的个人信息、处理的方式和目的，都应清晰准确的告知用户，并在适当情况下去的用户的同意授权。
GDPR第5条1（a）则说明“以对数据主体合法、公平和透明的方式而被处理”。

（1）是否有隐私政策、cookie政策提示

在这里，应用的开发中，其实不用关系隐私政策和cookie政策该如何编写，这个是法务人员职责。
但是应当在涉及到个人信息处理时，嵌入并展示相关政策。
有些cookie政策可能是全域性质的，需要应用设计前端展示、服务端记录等功能需求。

而在业务研发团队提交的信息中，也可同时反馈给DPO或者法务团队，及时更新隐私政策。

（2）收集前应当取得用户同意

除了《个人信息安全规范》和《个人信息告知同意指南》中规定的“征得同意例外”的选项，以及GDPR中，除“同意”以外的其他5项合法理由，其他都应先获取用户的明确同意。

这里有一点在“自动化”处理中遇到的问题，即业务研发选择的例外或者合法理由，未必是准确的，那么很有可能导致“应当取得用户同意”的安全需求，没有下发给业务研发。
因此，在该处，如果选择了例外情况，应当跳转至人工审批，对于没有例外情况的，应当明示给业务研发团队，以“同意”为基础，必须提供“撤回同意”的情况和例子。

（3）不得默认勾选

对于信息采集需同意的，不得默认勾选。
  在《个人信息同意告知指南》中，列出了6种明示同意的方法，该方法可以对应业务研发团队在之前提交的“采集方式”。

设置交互式界面，由个人信息主体做出主动勾选、主动点击“同意”“下一步”“继续”、滑动滑块、主动发送等动作表示意愿
由个人信息主体主动填写、输入个人信息表示意愿
由个人信息主体开启可收集个人信息的API、权限表示意愿
个人信息主体通过纸质或电子的书面声明、签字确认表示意愿
通过电子签名方式
通过电话录音、视频录像等方式

（4）需记录同意

在GDPR中，第7条规定，“控制者应当能证明数据主体已经同意处理其个人数据”。
因此，如果是基于用户同意，则需设计相关功能，记录数据主体的同意行为。

好了，这篇文章先把“个人信息采集”部分的自动化评审分享一下，后面我们再看其他部分的自动化审批。

## 数据安全合规实践（三）：数据溯源系统的思考 会员

我们都知道在数据治理中，最重要的三个系统是：
  数据资产管理系统（元数据管理系统）
  数据分类分级系统（数据标签管理系统）
  数据溯源系统（数据地图、数据血缘、数据流转图）

我认为目前大家所说的“数据溯源”有以下几个类型：
（1）单点溯源（2）大数据数据血缘（3）数据流转图

### 0x01 单点溯源
这个是目前市面上乙方厂商最多的产品。
  这类产品能解决的是两个节点之间的数据访问情况，
  但不能连成一张完整的网络，即一张完整的数据流转图。

这类里面有两类代表：
  （1）应用侧api治理（2）数据库侧数据库审计（3）DLP系统

（1）应用侧api治理

某数据安全明星厂商的一款产品，基于应用系统的流量分析，通过关键词、数据字典、正则表达式、语义分析等技术，分析出流量中的敏感数据；
  通过api接口中的关键词或者用户标注，识别出重点api，比如登录、数据查询等等；
  通过登录用户名、ip、session、时间戳等方式，跟踪用户访问行为。
  于是该产品便可以得到用户访问这些api的相关行为画像，然后根据之前设定的规则，如访问频率、访问时间、访问数据量等等，识别出异常行为。
  并且可以通过关键词查询，比如企业发现的泄露的电话号码，那查询是谁访问了该电话号码。

该技术，可以看出，其所能绘制的路径特点：
  因为基于应用流量，因此只能识别在应用侧的流转情况，而不能识别数据库侧
  应用侧的识别，也仅能识别“一跳”，即每两个节点之间的流转行为无法串联在一起

适用场景：
  正如该产品技术原理，其所适用的就是企业api治理，
    由于当前企业越来越多的应用系统，到底数据从哪些api进来，
    尤为重要的是敏感数据又从哪些api出去，是非常重要的。

待企业安全人员优化的地方：
  在试用的过程中，其实可以看出，其敏感数据识别的规则还是会有很多误报的地方，比如姓名等等，这些其实还需要进一步完善语义分析、词法分割等等。
  同时，api的分类往往也需要安全人员自行梳理，系统没法自动分出哪些是外部api，哪些是第三方应用系统访问的api。
  因此可以把这些数据作为基础初筛的数据，再辅助于企业的特点，制定第二层自定义规则，筛出重点关注的对象。
  比如以重点系统出发，或者以重点数据出发。

（2）数据库侧数据库审计

在数据库侧的产品，基本是从数据库审计产品延伸而来。
  目前，在溯源这一概念下，说的较多的是某厂商的三层关联。

其三层关联指的是识别 **用户-》应用-》数据库** 这三层的识别。
  其技术原理，是通过在应用服务器上，安装一个插件，该插件使用的是类似于IAST中使用的插桩技术，在访问数据库的请求中，插入唯一标记，这样将用户访问请求和数据库访问请求关联起来，从而实现三层关联。
  然后再通过数据库审计的相关技术，对数据库访问流量的异常行为进行分析。

该技术，可以看出，其所绘制的路径特点：
  其以访问数据库侧的路径为核心，三层关联是其拓展，但基于的还是数据库访问流量，而不是应用流量
  由于在数据资产识别、数据分类分级中，往往是依托于数据库信息，所以数据库侧的信息有助于分类分级在策略中的落地
  其和应用侧api治理相似，都只能实现“一跳”，即当有多个应用系统跳转访问时，则无法识别相关路径，也无法将每条路径串联起来。

适用场景：
  其和应用侧的产品是一个很好的补充，弥补应用侧产品无法涉及到数据库的部分。
  同时，其重点还在在数据库审计方面，类似于“三层关联”并不是其解决的核心问题，不要偏离重点。

待企业安全人员优化的地方：
  这里，需要企业安全人员考虑，如何将应用侧的信息和数据库侧的信息关联起来，形成一个较为完整的路径。
  但这里由于两者产品技术的局限性，即使融合在一起也无法串联出准确的数据流转图。
  重点在数据分类分级在数据库侧策略落地，异常访问可以结合到应用侧的行为分析和数据库侧的分类分级进行更精准的识别。

（3）DLP系统

DLP系统不用多说，上面两者不管是应用侧还是数据库侧，更多的都是针对结构化数据，对于非结构化数据，则难以覆盖。
  非结构化数据往往是通过DLP系统来管控。
  而当前越来越多的DLP的系统，都提出自己有数据泄露溯源的功能。
  该溯源技术，更多的便是通过水印的方式。

在这里，我们不过多的讲DLP，正如数据库审计更多是做对数据库操作行为的监控，而不是为了做溯源、流转的，DLP产品更多是对文件的外发等做行为的识别、管控，而不是做非结构化数据的流转的。
我们就简单的从数据水印来讲一讲。
  不可见字符：在结构化数据中，尤其是字符串类型，附加不可见字符
  浮点数变化：对某些数据，尤其类似浮点数类型，做小幅度数值改动
  仿真数据插入：在数据集中插入虚假的仿真数据作为标识
  文件可见水印：如我们常见的word文档中标注的工号水印等等
  文件不可见水印：即在文件头部中，写入一些标识信息等等

适用场景：
  这些水印方式，尤其是文件不可见水印，确实可以做到跟踪文档的流转，但对于文档的复制、截取则有一定的局限性。
  对于结构化数据，则在数据共享中有一定的意义，但对于绘制数据流转图则没有太多意义。
  关于水印的适用，我想在后面做数据共享安全技术分享的文章里面再详细谈谈我的看法。

### 0x02 大数据数据血缘

这一类产品，在大数据平台很多见，不管是当前的公有云平台提供的服务，
  如阿里云的dataworks
  还是各公司自建的大数据平台（如我司基于开源组件搭建的大数据平台），
  基本都能实现。

该技术是基于大数据在采集的时候，
  通过ETL或者相关数据采集、分发等过程中，
  记录下数据从哪张表、哪个字段来，又汇聚写入到哪张表、哪个字段去，
  由此来绘制相关所谓“数据血缘”的关系网。

由上述解释，其实就可以看出，为什么只有大数据平台可以做，以及其绘制的路径特点：
  该路径只覆盖通过ETL等方式从一个数据库到另一个数据的数据流转过程，中间不能有web应用系统等参与
  该路径很好的展示了大数据的数据来源，当数据采集的源头就是初始源头（如不是通过a系统采集的b系统，又流转至c系统），则对合规有很好的帮助

适用场景：
  适用于大数据平台、大数据分析的场景，对于应用间等数据流转则无法适用。

企业安全人员待优化的地方：

  其实这里需要企业安全人员关注几点，第一确定大数据的数据来源，最好是从原始数据入口系统处获取，比如会员注册系统，然后其他系统在获取信息时，最好都能从大数据平台的数据湖进行获取，比如通过大数据平台的api调取会员信息等等，这样会更方便进行数据流转的管控

### 0x03 数据流转图

我们在看外部分享，或是相关单位招标的过程中，涉及数据安全的建设中，往往涉及到三个交付物：数据资产清单，数据分类分级清单，数据流转图。
这里的数据流转图就不再仅仅只是满足与攻击溯源、数据泄露溯源这些，而是为了分析整体的数据安全风险，风险暴露面等等。

在数据流转图绘制方面，目前市面上我还没有发现相关安全产品，这种绘制基本上都是甲方自己进行或者是通过采购安全咨询服务来完成，也就是更多是靠人工来进行。
我们也在探索如何去实现，下面就说一下我们的几个不成熟的想法。

（1）我们公司是通过数据加密项目，来完成相关敏感数据流转的梳理的，
  即对数据源头进行加密，
  数据流转过程中，默认加密，
  谁使用谁申请解密，通过这样的方式，
  逐步强制研发上报，
  并结合调用加密机的情况，
  绘制出数据在哪些系统中流转。
这里有一个局限性，
  就是无法细致到api级别，所以我们又结合了api治理的产品，来进一步细化敏感数据的流动。
但还存在一个问题，即无法解决多数据来源的情况。
  比如身*份证信息，我们采集的时候，是从多个系统、多个api进入的，但是下游系统在获取时，并没有办法去区分他获取的这部分数据，来源于哪个入口。

（2）要解决（1）当中的问题，那么就绕不开数据标签的技术，这里的数据标签是和数据分类分级相关的标签。
现在更多采用的是分离标的方式，即通过一个数据标签系统，记录相关数据的性质，因为这样对应用系统的改造更小。
但当前更多的是对字段级别的数据打标签，而要实现数据流转图绘制，必须细致到每一行数据，这样分离标的实现就会遇到很多问题。

（3）目前，我所了解到，国内有一家研究机构，
    基于密码学方式，实现数据标签系统，
      对每一个采集的数据，形成一个数据指纹进行记录，
      即防止数据标签被篡改，
      又能关联到每一行数据。
但该产品目前并没有对企业市场开放，我也会进一步去研究学习，如果有大佬有相关的技术储备，可以留言交流学习。

（4）最后，我们目前公司也在考虑如何基于当前我们的数据加密体系，实现更细致的数据溯源、数据流转图绘制工作

[国家标准《数据安全能力成熟度模型》明年3月起实施 (附文件)](https://www.secrss.com/articles/13518)
[国家标准《个人信息安全规范》2020版正式发布 (附下载)](https://www.secrss.com/articles/17713)
[DPIA](https://ico.org.uk/for-organisations/guide-to-data-protection/guide-to-the-general-data-protection-regulation-gdpr/accountability-and-governance/data-protection-impact-assessments/)

